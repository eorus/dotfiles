# ===========================
# General Settings
# ===========================

prepopulate-query-feeds yes
run-on-startup select-tag

auto-reload yes
reload-time 900
reload-threads 4

download-retries 4
download-timeout 30

show-read-articles no
keep-articles-days 30
show-read-feeds no
max-items 4000
delete-read-articles-on-quit no

text-width 0
show-title-bar yes
confirm-exit no
cleanup-on-quit no

# ===========================
# Vim-like Key Bindings
# ===========================

bind-key j down
bind-key k up

# Article list navigation
bind-key j next articlelist
bind-key k prev articlelist

# Scroll inside article text
bind-key Down down
bind-key Up up

# Feed navigation
bind-key J next-feed articlelist
bind-key K prev-feed articlelist

# Toggle and navigation commands
bind-key S toggle-show-read-feeds
bind-key G end
bind-key g home
bind-key d pagedown
bind-key u pageup

# Article actions
bind-key l open
bind-key h quit
bind-key a toggle-article-read
bind-key n next-unread
bind-key N prev-unread

# Download & URL handling
bind-key D pb-download
bind-key U show-urls
bind-key x pb-delete

# Reload feeds
bind-key r reload
bind-key R reload-all

macro M mark-feed-read ; reload
macro O set browser "xdg-open %u"; open-in-browser; set browser "w3m %u"

# ===========================
# Display Settings
# ===========================

browser linkhandler
#browser "xdg-open %u"
external-url-viewer "urlscan"
html-renderer "w3m -dump -T text/html"

player "mpv"

save-path ~/Downloads/

pager internal
article-sort-order date-asc

datetime-format "%Y-%m-%d"

show-keymap-hint yes
notify-always yes
notify-program "notify-send"
notify-format "%n unread articles"

# ===========================
# Macros (Custom Commands)
# ===========================

macro o open-in-browser ; toggle-article-read "read"

macro b set browser "brave"; open-in-browser ; set browser linkhandler
macro f set browser "firefox"; open-in-browser ; set browser linkhandler
macro i set browser "/usr/bin/vimiv %u"; open-in-browser ; set browser "/usr/bin/w3m %u"
macro v set browser "mpv --pause %u &"; open-in-browser-noninteractively; set browser "brave %u"
macro w set browser "w3m"; open-in-browser ; set browser linkhandler
macro p set browser "dmenuhandler"; open-in-browser ; set browser linkhandler
macro c set browser "xsel -b <<<" ; open-in-browser ; set browser linkhandler
macro m set browser "setsid -f mpv" ; open-in-browser ; set browser linkhandler
macro d set browser "yt-dlp"; open-in-browser ; set browser linkhandler
macro a set browser "yt-dlp --embed-metadata -xic -f bestaudio/best %u" ; open-in-browser ; set browser linkhandler
macro u pipe-to "urlscan"

# ===========================
# Theme / Colors (Light Theme)
# ===========================

# Feed list colors
color listnormal          color7     default    # Light gray text
color listnormal_unread   color10    default    # Bright green for unread
color listfocus           black      color11    # Black text on yellow background
color listfocus_unread    black      color10    # Black text on green background
# Info line colors
color info                color14    default    # Cyan-ish

# Article colors
color article             white      default

highlight all "---.*---" yellow
highlight feedlist ".*(0/0))" black
highlight article "(^Feed:.*|^Title:.*|^Author:.*)" cyan default bold
highlight article "(^Link:.*|^Date:.*)" default default
highlight article "https?://[^ ]+" green default
highlight article "^(Title):.*$" blue default
highlight article "\\[[0-9][0-9]*\\]" magenta default bold
highlight article "\\[image\\ [0-9]+\\]" green default bold
highlight article "\\[embedded flash: [0-9][0-9]*\\]" green default bold
highlight article ":.*\\(link\\)$" cyan default
highlight article ":.*\\(image\\)$" blue default
highlight article ":.*\\(embedded flash\\)$" magenta default
